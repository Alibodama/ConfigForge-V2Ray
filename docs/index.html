<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ConfigForge V2Ray — Speed-tested global & country subscriptions</title>

  <!-- SEO -->
  <meta name="description" content="Speed-tested V2Ray subscriptions (VLESS, VMess, Shadowsocks, Trojan). Copy-ready links by country or global. Lightweight, multilingual, mobile-friendly." />
  <link rel="canonical" href="https://shatakvpn.github.io/ConfigForge-V2Ray/" />
  <meta name="robots" content="index,follow,max-image-preview:large,max-snippet:-1,max-video-preview:-1" />

  <!-- OpenGraph / Twitter -->
  <meta property="og:title" content="ConfigForge V2Ray" />
  <meta property="og:description" content="Speed-tested, copy-ready V2Ray subscriptions by country or global." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://opengraph.githubassets.com/1/ShatakVPN/ConfigForge-V2Ray" />
  <meta property="og:url" content="https://shatakvpn.github.io/ConfigForge-V2Ray/" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- JSON-LD (Organization + WebSite) -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebSite",
    "name":"ConfigForge V2Ray",
    "url":"https://shatakvpn.github.io/ConfigForge-V2Ray/",
    "sameAs":["https://github.com/ShatakVPN"]
  }
  </script>

  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>⚙️</text></svg>">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js"></script>

  <style>
    :root{
      --fg:#e2e8f0; --muted:#cbd5e1; --glass:rgba(255,255,255,0.05);
      --line:rgba(255,255,255,0.12); --ok:#10b981; --err:#ef4444; --warn:#f59e0b;
      --btn-label-w: 7.5rem; /* عرض رزروشده برای لیبل دکمه‌ها (بدون تغییر با زبان) */
    }
    @media (max-width: 480px){ :root{ --btn-label-w: 0rem; } } /* موبایل = فقط آیکون */

    *{ box-sizing: border-box }
    body{
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--fg);
      min-height:100vh; display:flex; flex-direction:column; align-items:center; gap:2rem;
      background:
        radial-gradient(1200px 600px at 80% -10%, rgba(124,58,237,.22), transparent 60%),
        radial-gradient(900px 500px at 0% 100%, rgba(59,130,246,.16), transparent 60%),
        linear-gradient(180deg, rgba(10,25,47,.96), rgba(30,41,59,.96));
      padding: 4rem 1rem;
    }
    .container{
      width:min(1050px, 100%); position:relative; padding:2rem; border-radius:18px;
      background:var(--glass); border:1px solid var(--line); backdrop-filter: blur(16px);
      box-shadow: 0 18px 60px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.04);
      animation: fade-in .5s ease both;
    }
    .container::before{
      content:""; position:absolute; inset:-1px; border-radius:20px; padding:1px;
      background: linear-gradient(135deg, rgba(124,58,237,.5), rgba(59,130,246,.5));
      -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); -webkit-mask-composite:xor; mask-composite:exclude;
      pointer-events:none;
    }
    @keyframes fade-in{ from{opacity:0; transform:translateY(-12px)} to{opacity:1; transform:none} }

    h1{ margin:0 0 .35rem; font-weight:700; color:#fff; letter-spacing:-.02em; text-align:center }
    .kicker{ text-align:center; color:var(--muted); margin-bottom:1rem; font-size:.95rem }

    .toolbar{ display:flex; gap:.75rem; align-items:center; justify-content:space-between; flex-wrap:wrap; margin-bottom:.75rem }
    #language-select{ width:160px }

    .badge-row{ display:flex; gap:.5rem; flex-wrap:wrap; justify-content:center; margin-bottom:1rem }
    .btn-ghost{ color:var(--fg)!important; border:1px solid rgba(255,255,255,.16)!important; background:rgba(255,255,255,.05)!important }
    .chip{ display:inline-flex; align-items:center; gap:.5rem; border:1px solid rgba(255,255,255,.14); background:rgba(255,255,255,.08); padding:.35rem .6rem; border-radius:999px; font-size:.85rem; white-space:nowrap }
    .chip b{ font-weight:600 }

    .description{ text-align:center; color:var(--muted); margin:.25rem 0 1rem }

    .nav-tabs{ border:none; justify-content:center; margin-bottom:1rem }
    .nav-tabs .nav-link{ background:rgba(255,255,255,.08); color:var(--fg); border:none; border-radius:10px 10px 0 0; margin:0 .5rem }
    .nav-tabs .nav-link.active{ background:rgba(255,255,255,.2); color:#fff; box-shadow:0 -2px 10px rgba(0,0,0,.2) }

    .card-lite{ background:rgba(255,255,255,.08); border:1px solid var(--line); border-radius:14px; padding:1rem }
    .grid{ display:grid; grid-template-columns:repeat(auto-fit, minmax(240px, 1fr)); gap:.8rem }
    .config-card{ transition: transform .15s ease, box-shadow .15s ease }
    .config-card:hover{ transform:translateY(-2px); box-shadow:0 10px 26px rgba(0,0,0,.25) }

    /* دکمه‌ها همیشه استیبل */
    .btn-group, .btn-group-sm{ flex-wrap:nowrap }
    .btn-icon{ display:inline-flex; align-items:center; gap:.45rem; white-space:nowrap }
    .btn-icon .label{ inline-size:var(--btn-label-w); overflow:hidden; text-overflow:ellipsis; font-weight:600; font-size:.85rem; text-align:start }
    .btn-icon .ico{ font-size:1rem; flex:0 0 auto }
    .btn-group-sm>.btn, .btn-sm{ padding:.35rem .6rem }
    .form-select, .btn{ font-size:.95rem }

    .controls-row{ display:grid; grid-template-columns: 1fr 1fr; gap:.75rem }
    @media (max-width: 576px){ .controls-row{ grid-template-columns: 1fr } }

    .error-message{ color:#f87171; text-align:center; font-weight:500 }
    .loading-spinner{ text-align:center; font-size:1.1rem }

    footer{ color:var(--muted); text-align:center; font-size:.9rem; padding:1rem 0 }
    footer a{ color:#93c5fd; text-decoration:none; font-weight:600 }
    footer a:hover{ text-decoration:underline; color:#fff }

    [dir="rtl"]{ text-align:right }
    .parallax{ position:fixed; inset:0; pointer-events:none; opacity:.18; background:
      radial-gradient(1000px 400px at 80% -10%, rgba(124,58,237,.35), transparent 55%),
      radial-gradient(800px 360px at 0% 100%, rgba(59,130,246,.25), transparent 55%);
      mix-blend-mode:screen;
    }
    @media (prefers-reduced-motion: reduce){ .config-card:hover{ transform:none } }
  </style>
</head>
<body>
  <div class="parallax" aria-hidden="true"></div>

  <div class="container" role="main">
    <div class="toolbar">
      <div class="flex-grow-1">
        <h1 id="i-title">ConfigForge V2Ray</h1>
        <p class="kicker" id="i-kicker">Speed-tested subscriptions · VLESS · VMess · Shadowsocks · Trojan</p>
      </div>
      <select id="language-select" class="form-select" aria-label="Language">
        <option value="en">English</option><option value="fa">فارسی</option><option value="zh">中文 (简体)</option>
        <option value="es">Español</option><option value="fr">Français</option><option value="de">Deutsch</option>
        <option value="ru">Русский</option><option value="ar">العربية</option><option value="ja">日本語</option>
        <option value="ko">한국어</option><option value="hi">हिन्दी</option><option value="pt">Português</option>
        <option value="it">Italiano</option><option value="tr">Türkçe</option><option value="nl">Nederlands</option>
      </select>
    </div>

    <div class="badge-row">
      <a class="btn btn-sm btn-ghost" href="https://github.com/ShatakVPN/ConfigForge-V2Ray" target="_blank" rel="noopener">⭐ <span data-i18n="star">Star</span></a>
      <a class="btn btn-sm btn-ghost" href="https://github.com/ShatakVPN/ConfigForge-V2Ray/releases" target="_blank" rel="noopener">📦 <span data-i18n="releases">Releases</span></a>
      <span class="chip"><b id="i-speed">Speed test</b> <span id="speed-dot" style="width:.6rem;height:.6rem;border-radius:50%;background:var(--warn);display:inline-block"></span></span>
      <span class="chip"><b id="i-updated">Updated</b> <span id="i-updated-when">—</span></span>
    </div>

    <p class="description" id="i-desc">Pick a country or use global subscriptions. Click a card to copy the URL.</p>

    <ul class="nav nav-tabs" role="tablist">
      <li class="nav-item"><button class="nav-link active" id="i-tab-configs" data-bs-toggle="tab" data-bs-target="#tab-configs" type="button" role="tab">Get Configs</button></li>
      <li class="nav-item"><button class="nav-link" id="i-tab-how" data-bs-toggle="tab" data-bs-target="#tab-how" type="button" role="tab">How to Use</button></li>
      <li class="nav-item"><button class="nav-link" id="i-tab-contact" data-bs-toggle="tab" data-bs-target="#tab-contact" type="button" role="tab">Contact</button></li>
    </ul>

    <div class="tab-content">
      <!-- CONFIGS -->
      <div class="tab-pane fade show active" id="tab-configs" role="tabpanel">
        <!-- Global -->
        <div class="card-lite mb-3">
          <div class="d-flex justify-content-between align-items-center flex-wrap gap-2">
            <strong id="i-global-title">Global subscriptions</strong>
            <div class="d-flex align-items-center gap-2 flex-wrap">
              <small class="text-secondary" id="i-global-hint">Works in most clients. Click to copy.</small>
              <button id="btn-copy-global" class="btn btn-sm btn-ghost btn-icon"><span class="ico">📋</span><span class="label" data-i18n-btn="copyAll">Copy all</span></button>
            </div>
          </div>
          <div id="global-list" class="grid mt-2" aria-live="polite"></div>
        </div>

        <!-- Country controls -->
        <div class="card-lite mb-3">
          <div class="controls-row">
            <div>
              <label class="form-label" id="i-country-label" for="country-select">Country</label>
              <div class="d-flex gap-2">
                <select id="country-select" class="form-select" aria-label="Country">
                  <option value="">Select Country</option>
                  <!-- کشورهای محبوب (localStorage) بالای لیست تزریق می‌شن -->
                  <optgroup id="fav-group" label="★ Favorites" hidden></optgroup>
                  <optgroup id="all-group" label="All countries"></optgroup>
                </select>
                <button id="btn-fav" class="btn btn-ghost btn-icon" title="Toggle favorite" data-bs-toggle="tooltip"><span class="ico">★</span><span class="label" data-i18n-btn="fav">Favorite</span></button>
              </div>
            </div>
            <div>
              <label class="form-label" for="country-search" id="i-country-search-label">Search</label>
              <input id="country-search" class="form-control" type="search" placeholder="Type to filter…" autocomplete="off"/>
            </div>
          </div>
          <div class="mt-2 d-flex gap-2">
            <button id="btn-load-country" class="btn btn-primary btn-icon"><span class="ico">🚀</span><span class="label" data-i18n-btn="get">Get Configs</span></button>
            <button id="btn-copy-country" class="btn btn-ghost btn-icon"><span class="ico">📋</span><span class="label" data-i18n-btn="copyAll">Copy all</span></button>
            <button id="btn-show-qr" class="btn btn-ghost btn-icon"><span class="ico">🧾</span><span class="label" data-i18n-btn="qr">QR</span></button>
          </div>
        </div>

        <!-- Lists -->
        <div id="country-list" class="grid" aria-live="polite"></div>
      </div>

      <!-- HOW TO -->
      <div class="tab-pane fade" id="tab-how" role="tabpanel">
        <div class="card-lite">
          <h3 class="h5 mb-3" id="i-how-title">Quick import</h3>
          <ol class="mb-3" id="i-how-steps">
            <li>Copy a subscription URL from a card.</li>
            <li>Open your client (v2rayNG, V2RayN, Shadowrocket, etc.).</li>
            <li>Subscriptions → Add → paste URL → Update.</li>
          </ol>
          <div class="row g-3">
            <div class="col-md-6">
              <div class="card-lite p-3">
                <strong>Android</strong>
                <ul class="mb-0">
                  <li><a href="https://github.com/2dust/v2rayNG" target="_blank" rel="noopener" aria-label="v2rayNG GitHub">v2rayNG</a></li>
                  <li><a href="https://github.com/MatsuriDayo/NekoBoxForAndroid" target="_blank" rel="noopener" aria-label="NekoBox For Android GitHub">NekoBox</a></li>
                </ul>
              </div>
            </div>
            <div class="col-md-6">
              <div class="card-lite p-3">
                <strong>iOS</strong>
                <ul class="mb-0">
                  <li><a href="https://apps.apple.com/us/app/shadowrocket/id932747118" target="_blank" rel="noopener" aria-label="Shadowrocket on App Store">Shadowrocket</a></li>
                  <li><a href="https://apps.apple.com/us/app/quantumult-x/id1443988620" target="_blank" rel="noopener" aria-label="Quantumult X on App Store">Quantumult X</a></li>
                </ul>
              </div>
            </div>
            <div class="col-md-6">
              <div class="card-lite p-3 mt-3">
                <strong>Windows</strong>
                <ul class="mb-0">
                  <li><a href="https://github.com/2dust/v2rayN" target="_blank" rel="noopener" aria-label="V2RayN GitHub">V2RayN</a></li>
                  <li><a href="https://github.com/Qv2ray/Qv2ray" target="_blank" rel="noopener" aria-label="Qv2ray GitHub">Qv2ray</a></li>
                </ul>
              </div>
            </div>
            <div class="col-md-6">
              <div class="card-lite p-3 mt-3">
                <strong>Linux / Mac</strong>
                <ul class="mb-0">
                  <li><a href="https://github.com/v2rayA/v2rayA" target="_blank" rel="noopener" aria-label="v2rayA GitHub">v2rayA</a></li>
                  <li><a href="https://github.com/yanue/V2rayU" target="_blank" rel="noopener" aria-label="V2RayU GitHub">V2RayU (macOS)</a></li>
                  <li><a href="https://github.com/yichengchen/clashX" target="_blank" rel="noopener" aria-label="ClashX GitHub">ClashX (macOS)</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- CONTACT -->
      <div class="tab-pane fade" id="tab-contact" role="tabpanel">
        <div class="card-lite p-3 text-center">
          <p id="i-contact">Reach us on GitHub or email.</p>
          <p class="mb-0"><a href="https://github.com/ShatakVPN" target="_blank" rel="noopener">GitHub: ShatakVPN</a> · <a href="mailto:ShatakVPN@gmail.com">ShatakVPN@gmail.com</a></p>
        </div>
      </div>
    </div>
  </div>

  <footer>Built with ❤️ by <a href="https://github.com/ShatakVPN" target="_blank" rel="noopener">ShatakVPN</a> · Powered by <a href="https://github.com" target="_blank" rel="noopener">GitHub</a> & <a href="https://check-host.net" target="_blank" rel="noopener">Check-Host</a></footer>

  <!-- Toast -->
  <div class="position-fixed top-0 end-0 p-3" style="z-index:1080">
    <div id="toast" class="toast align-items-center text-bg-dark border-0" role="status" aria-live="polite" aria-atomic="true">
      <div class="d-flex">
        <div id="toast-body" class="toast-body">Copied to clipboard.</div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>
  </div>

  <!-- QR Modal -->
  <div class="modal fade" id="qrModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content text-bg-dark">
        <div class="modal-header">
          <h5 class="modal-title" id="qrTitle">QR</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body d-flex justify-content-center">
          <canvas id="qrCanvas" width="256" height="256" aria-label="QR"></canvas>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Twemoji
    twemoji.parse(document.body, { folder:'svg', ext:'.svg', base:'https://cdn.jsdelivr.net/npm/twemoji@14.0.2/2/' });

    // ===== i18n =====
    const i18n = {
      en:{title:'ConfigForge V2Ray',kicker:'Speed-tested subscriptions · VLESS · VMess · Shadowsocks · Trojan',desc:'Pick a country or use global subscriptions. Click a card to copy the URL.',
          tabCfg:'Get Configs',tabHow:'How to Use',tabContact:'Contact',
          star:'Star',releases:'Releases',updated:'Updated',speed:'Speed test',ready:'Online',offline:'Offline',
          country:'Country',select:'Select Country',search:'Search',hintGlobal:'Works in most clients. Click to copy.',
          how:'Quick import',howSteps:['Copy a subscription URL from a card.','Open your client (v2rayNG, V2RayN, Shadowrocket, etc.).','Subscriptions → Add → paste URL → Update.'],
          contact:'Reach us on GitHub or email.',btnGet:'Get Configs',btnCopy:'Copy',btnOpen:'Open',btnCopyAll:'Copy all',btnFav:'Favorite',btnQR:'QR',toastCopied:'Copied to clipboard.',toastCopiedAll:'All URLs copied.',
          ogFav:'★ Favorites',ogAll:'All countries'
      },
      fa:{title:'ConfigForge V2Ray',kicker:'ساب‌های تست‌شده · VLESS · VMess · Shadowsocks · Trojan',desc:'کشور را انتخاب کنید یا از ساب‌های عمومی استفاده کنید. روی کارت کلیک کنید تا لینک کپی شود.',
          tabCfg:'دریافت کانفیگ',tabHow:'روش استفاده',tabContact:'ارتباط',
          star:'ستاره',releases:'ریلیزها',updated:'بروزرسانی',speed:'تست سرعت',ready:'آنلاین',offline:'آفلاین',
          country:'کشور',select:'انتخاب کشور',search:'جست‌وجو',hintGlobal:'در اکثر کلاینت‌ها کار می‌کند. کلیک = کپی.',
          how:'ورود سریع',howSteps:['یک لینک اشتراک را از کارت کپی کنید.','کلاینت خود را باز کنید (v2rayNG، V2RayN، Shadowrocket و …).','Subscriptions → Add → پیست لینک → Update.'],
          contact:'در گیت‌هاب یا ایمیل پیام بدهید.',btnGet:'دریافت کانفیگ',btnCopy:'کپی',btnOpen:'باز کردن',btnCopyAll:'کپی همه',btnFav:'محبوب',btnQR:'QR',toastCopied:'در کلیپ‌بورد کپی شد.',toastCopiedAll:'همه لینک‌ها کپی شد.',
          ogFav:'★ محبوب‌ها',ogAll:'همه کشورها'
      },
      zh:{title:'ConfigForge V2Ray',kicker:'测速订阅 · VLESS · VMess · Shadowsocks · Trojan',desc:'选择国家或使用全局订阅。点击卡片复制链接。',
          tabCfg:'获取配置',tabHow:'使用方法',tabContact:'联系我们',
          star:'收藏',releases:'发布',updated:'更新时间',speed:'测速',ready:'在线',offline:'离线',
          country:'国家/地区',select:'选择国家',search:'搜索',hintGlobal:'适用于大多数客户端。点击复制。',
          how:'快速导入',howSteps:['从卡片复制订阅链接。','打开客户端（v2rayNG、V2RayN、Shadowrocket 等）。','Subscriptions → Add → 粘贴链接 → Update.'],
          contact:'通过 GitHub 或邮箱联系。',btnGet:'获取',btnCopy:'复制',btnOpen:'打开',btnCopyAll:'全部复制',btnFav:'收藏',btnQR:'QR',toastCopied:'已复制到剪贴板。',toastCopiedAll:'已复制全部链接。',
          ogFav:'★ 收藏',ogAll:'全部国家'
      },
      es:{title:'ConfigForge V2Ray',kicker:'Suscripciones probadas · VLESS · VMess · Shadowsocks · Trojan',desc:'Elige un país o global. Haz clic para copiar.',
          tabCfg:'Obtener',tabHow:'Cómo usar',tabContact:'Contacto',
          star:'Star',releases:'Releases',updated:'Actualizado',speed:'Test de velocidad',ready:'En línea',offline:'Fuera de línea',
          country:'País',select:'Seleccionar país',search:'Buscar',hintGlobal:'Funciona en la mayoría de clientes.',
          how:'Importación rápida',howSteps:['Copia un enlace.','Abre tu cliente.','Subscriptions → Add → pega → Update.'],
          contact:'Contáctanos por GitHub o email.',btnGet:'Obtener',btnCopy:'Copiar',btnOpen:'Abrir',btnCopyAll:'Copiar todo',btnFav:'Favorito',btnQR:'QR',toastCopied:'Copiado.',toastCopiedAll:'Todos copiados.',
          ogFav:'★ Favoritos',ogAll:'Todos los países'
      },
      fr:{title:'ConfigForge V2Ray',kicker:'Abonnements testés · VLESS · VMess · Shadowsocks · Trojan',desc:'Choisissez un pays ou global. Cliquez pour copier.',
          tabCfg:'Obtenir',tabHow:'Mode d’emploi',tabContact:'Contact',
          star:'Étoile',releases:'Versions',updated:'Mise à jour',speed:'Test vitesse',ready:'En ligne',offline:'Hors ligne',
          country:'Pays',select:'Sélectionner un pays',search:'Recherche',hintGlobal:'Fonctionne dans la plupart des clients.',
          how:'Import rapide',howSteps:['Copiez un lien.','Ouvrez votre client.','Subscriptions → Add → collez → Update.'],
          contact:'Contact via GitHub ou email.',btnGet:'Obtenir',btnCopy:'Copier',btnOpen:'Ouvrir',btnCopyAll:'Tout copier',btnFav:'Favori',btnQR:'QR',toastCopied:'Copié.',toastCopiedAll:'Tous copiés.',
          ogFav:'★ Favoris',ogAll:'Tous les pays'
      },
      de:{title:'ConfigForge V2Ray',kicker:'Getestete Abos · VLESS · VMess · Shadowsocks · Trojan',desc:'Land wählen oder global. Klick zum Kopieren.',
          tabCfg:'Abrufen',tabHow:'Anleitung',tabContact:'Kontakt',
          star:'Stern',releases:'Releases',updated:'Aktualisiert',speed:'Speedtest',ready:'Online',offline:'Offline',
          country:'Land',select:'Land wählen',search:'Suche',hintGlobal:'Funktioniert in den meisten Clients.',
          how:'Schnellimport',howSteps:['Link kopieren.','Client öffnen.','Subscriptions → Add → einfügen → Update.'],
          contact:'Kontakt per GitHub/E-Mail.',btnGet:'Abrufen',btnCopy:'Kopieren',btnOpen:'Öffnen',btnCopyAll:'Alle kopieren',btnFav:'Favorit',btnQR:'QR',toastCopied:'Kopiert.',toastCopiedAll:'Alle kopiert.',
          ogFav:'★ Favoriten',ogAll:'Alle Länder'
      },
      ru:{title:'ConfigForge V2Ray',kicker:'Проверенные подписки · VLESS · VMess · Shadowsocks · Trojan',desc:'Выберите страну или глобально. Клик — копия.',
          tabCfg:'Получить',tabHow:'Как использовать',tabContact:'Контакты',
          star:'Избранное',releases:'Релизы',updated:'Обновлено',speed:'Тест скорости',ready:'Онлайн',offline:'Офлайн',
          country:'Страна',select:'Выбрать страну',search:'Поиск',hintGlobal:'Работает в большинстве клиентов.',
          how:'Быстрый импорт',howSteps:['Скопируйте ссылку.','Откройте клиент.','Subscriptions → Add → вставить → Update.'],
          contact:'Связь через GitHub/email.',btnGet:'Получить',btnCopy:'Копия',btnOpen:'Открыть',btnCopyAll:'Копировать всё',btnFav:'Избранное',btnQR:'QR',toastCopied:'Скопировано.',toastCopiedAll:'Все скопированы.',
          ogFav:'★ Избранное',ogAll:'Все страны'
      },
      ar:{title:'ConfigForge V2Ray',kicker:'اشتراكات مُختبرة · VLESS · VMess · Shadowsocks · Trojan',desc:'اختر دولة أو عام. انقر للنسخ.',
          tabCfg:'الحصول',tabHow:'كيفية الاستخدام',tabContact:'اتصال',
          star:'نجمة',releases:'الإصدارات',updated:'آخر تحديث',speed:'اختبار السرعة',ready:'متصل',offline:'غير متصل',
          country:'البلد',select:'اختر البلد',search:'بحث',hintGlobal:'يعمل مع معظم العملاء.',
          how:'استيراد سريع',howSteps:['انسخ الرابط.','افتح التطبيق.','Subscriptions → Add → لصق → Update.'],
          contact:'تواصل عبر GitHub أو البريد.',btnGet:'جلب',btnCopy:'نسخ',btnOpen:'فتح',btnCopyAll:'نسخ الكل',btnFav:'مفضل',btnQR:'QR',toastCopied:'تم النسخ.',toastCopiedAll:'نُسخ الكل.',
          ogFav:'★ المفضلة',ogAll:'كل البلدان'
      },
      ja:{title:'ConfigForge V2Ray',kicker:'速度テスト済み · VLESS · VMess · Shadowsocks · Trojan',desc:'国またはグローバルを選択。クリックでコピー。',
          tabCfg:'取得',tabHow:'使い方',tabContact:'連絡先',
          star:'スター',releases:'リリース',updated:'更新',speed:'速度テスト',ready:'オンライン',offline:'オフライン',
          country:'国',select:'国を選択',search:'検索',hintGlobal:'多くのクライアントで動作。',
          how:'クイック導入',howSteps:['リンクをコピー。','クライアントを開く。','Subscriptions → Add → 貼り付け → Update.'],
          contact:'GitHub/メールで連絡。',btnGet:'取得',btnCopy:'コピー',btnOpen:'開く',btnCopyAll:'すべてコピー',btnFav:'お気に入り',btnQR:'QR',toastCopied:'コピーしました。',toastCopiedAll:'すべてコピーしました。',
          ogFav:'★ お気に入り',ogAll:'全ての国'
      },
      ko:{title:'ConfigForge V2Ray',kicker:'속도 테스트 · VLESS · VMess · Shadowsocks · Trojan',desc:'국가 또는 글로벌 선택. 클릭하면 복사.',
          tabCfg:'가져오기',tabHow:'사용 방법',tabContact:'문의',
          star:'즐겨찾기',releases:'릴리스',updated:'업데이트',speed:'속도 테스트',ready:'온라인',offline:'오프라인',
          country:'국가',select:'국가 선택',search:'검색',hintGlobal:'대부분의 클라이언트에서 작동.',
          how:'빠른 가져오기',howSteps:['링크 복사.','클라이언트 열기.','Subscriptions → Add → 붙여넣기 → Update.'],
          contact:'GitHub/이메일.',btnGet:'가져오기',btnCopy:'복사',btnOpen:'열기',btnCopyAll:'전체 복사',btnFav:'즐겨찾기',btnQR:'QR',toastCopied:'복사됨.',toastCopiedAll:'모두 복사됨.',
          ogFav:'★ 즐겨찾기',ogAll:'모든 국가'
      },
      hi:{title:'ConfigForge V2Ray',kicker:'स्पीड-टेस्टेड · VLESS · VMess · Shadowsocks · Trojan',desc:'देश या ग्लोबल चुनें। क्लिक से कॉपी।',
          tabCfg:'प्राप्त करें',tabHow:'उपयोग',tabContact:'संपर्क',
          star:'स्टार',releases:'रिलीज़',updated:'अपडेट',speed:'स्पीड टेस्ट',ready:'ऑनलाइन',offline:'ऑफ़लाइन',
          country:'देश',select:'देश चुनें',search:'खोज',hintGlobal:'अधिकांश क्लाइंट में काम करता है।',
          how:'त्वरित इंपोर्ट',howSteps:['लिंक कॉपी करें।','क्लाइंट खोलें।','Subscriptions → Add → पेस्ट → Update.'],
          contact:'GitHub/ईमेल।',btnGet:'लाओ',btnCopy:'कॉपी',btnOpen:'खोलें',btnCopyAll:'सब कॉपी',btnFav:'प्रिय',btnQR:'QR',toastCopied:'कॉपी हुआ।',toastCopiedAll:'सब कॉपी हुआ।',
          ogFav:'★ प्रिय',ogAll:'सभी देश'
      },
      pt:{title:'ConfigForge V2Ray',kicker:'Assinaturas testadas · VLESS · VMess · Shadowsocks · Trojan',desc:'Escolha um país ou global. Clique para copiar.',
          tabCfg:'Buscar',tabHow:'Como usar',tabContact:'Contato',
          star:'Star',releases:'Releases',updated:'Atualizado',speed:'Teste de velocidade',ready:'Online',offline:'Offline',
          country:'País',select:'Selecionar país',search:'Buscar',hintGlobal:'Funciona na maioria dos clientes.',
          how:'Importação rápida',howSteps:['Copie o link.','Abra o cliente.','Subscriptions → Add → colar → Update.'],
          contact:'GitHub ou e-mail.',btnGet:'Buscar',btnCopy:'Copiar',btnOpen:'Abrir',btnCopyAll:'Copiar tudo',btnFav:'Favorito',btnQR:'QR',toastCopied:'Copiado.',toastCopiedAll:'Tudo copiado.',
          ogFav:'★ Favoritos',ogAll:'Todos os países'
      },
      it:{title:'ConfigForge V2Ray',kicker:'Abbonamenti testati · VLESS · VMess · Shadowsocks · Trojan',desc:'Scegli un paese o globale. Clic per copiare.',
          tabCfg:'Ottieni',tabHow:'Guida',tabContact:'Contatti',
          star:'Stella',releases:'Rilasci',updated:'Aggiornato',speed:'Test velocità',ready:'Online',offline:'Offline',
          country:'Paese',select:'Seleziona Paese',search:'Cerca',hintGlobal:'Funziona nella maggior parte dei client.',
          how:'Import rapido',howSteps:['Copia link.','Apri client.','Subscriptions → Add → incolla → Update.'],
          contact:'GitHub o email.',btnGet:'Ottieni',btnCopy:'Copia',btnOpen:'Apri',btnCopyAll:'Copia tutto',btnFav:'Preferito',btnQR:'QR',toastCopied:'Copiato.',toastCopiedAll:'Tutto copiato.',
          ogFav:'★ Preferiti',ogAll:'Tutti i paesi'
      },
      tr:{title:'ConfigForge V2Ray',kicker:'Hız testli · VLESS · VMess · Shadowsocks · Trojan',desc:'Ülke veya global seç. Tıklayınca kopyalanır.',
          tabCfg:'Al',tabHow:'Kullanım',tabContact:'İletişim',
          star:'Yıldız',releases:'Sürümler',updated:'Güncellendi',speed:'Hız testi',ready:'Çevrimiçi',offline:'Çevrimdışı',
          country:'Ülke',select:'Ülke seç',search:'Ara',hintGlobal:'Çoğu istemcide çalışır.',
          how:'Hızlı import',howSteps:['Bağlantıyı kopyala.','İstemciyi aç.','Subscriptions → Add → yapıştır → Update.'],
          contact:'GitHub/e-posta.',btnGet:'Al',btnCopy:'Kopya',btnOpen:'Aç',btnCopyAll:'Hepsini kopyala',btnFav:'Favori',btnQR:'QR',toastCopied:'Kopyalandı.',toastCopiedAll:'Hepsi kopyalandı.',
          ogFav:'★ Favoriler',ogAll:'Tüm ülkeler'
      },
      nl:{title:'ConfigForge V2Ray',kicker:'Geteste abonnementen · VLESS · VMess · Shadowsocks · Trojan',desc:'Kies een land of globaal. Klik om te kopiëren.',
          tabCfg:'Ophalen',tabHow:'Handleiding',tabContact:'Contact',
          star:'Ster',releases:'Releases',updated:'Bijgewerkt',speed:'Snelheidstest',ready:'Online',offline:'Offline',
          country:'Land',select:'Selecteer land',search:'Zoeken',hintGlobal:'Werkt in de meeste clients.',
          how:'Snel importeren',howSteps:['Kopieer link.','Open client.','Subscriptions → Add → plak → Update.'],
          contact:'GitHub of e-mail.',btnGet:'Ophalen',btnCopy:'Kopiëren',btnOpen:'Openen',btnCopyAll:'Alles kopiëren',btnFav:'Favoriet',btnQR:'QR',toastCopied:'Gekopieerd.',toastCopiedAll:'Alles gekopieerd.',
          ogFav:'★ Favorieten',ogAll:'Alle landen'
      }
    };

    // ===== Helpers =====
    const $ = sel => document.querySelector(sel);
    const $$ = sel => Array.from(document.querySelectorAll(sel));
    const prefersLang = localStorage.getItem('cfg-lang') || (navigator.language||'en').slice(0,2);
    let lang = i18n[prefersLang] ? prefersLang : 'en';
    const CONFIG_ROOT = 'https://raw.githubusercontent.com/ShatakVPN/ConfigForge-V2Ray/main/configs';
    const FILES = ['all.txt','light.txt','vless.txt','vmess.txt','shadowsocks.txt','trojan.txt','unknown.txt'];
    const toastEl = $('#toast'); const toastBody = $('#toast-body'); let bsToast;

    function toast(msg){
      toastBody.textContent = msg; if(!bsToast) bsToast = new bootstrap.Toast(toastEl, { delay:1700 }); bsToast.show();
    }
    async function headOK(url){ try{ const r=await fetch(url,{method:'HEAD',cache:'no-store'}); return r.ok }catch{return false} }

    // ===== Countries =====
    const rawCountries = [
      ['at','🇦🇹 Austria'],['au','🇦🇺 Australia'],['bg','🇧🇬 Bulgaria'],['br','🇧🇷 Brazil'],['ca','🇨🇦 Canada'],
      ['ch','🇨🇭 Switzerland'],['cz','🇨🇿 Czech Republic'],['de','🇩🇪 Germany'],['es','🇪🇸 Spain'],['fi','🇫🇮 Finland'],
      ['fr','🇫🇷 France'],['gb','🇬🇧 United Kingdom'],['hk','🇭🇰 Hong Kong'],['hu','🇭🇺 Hungary'],['id','🇮🇩 Indonesia'],
      ['il','🇮🇱 Israel'],['in','🇮🇳 India'],['ir','🇮🇷 Iran'],['it','🇮🇹 Italy'],['jp','🇯🇵 Japan'],['kr','🇰🇷 South Korea'],
      ['kz','🇰🇿 Kazakhstan'],['lt','🇱🇹 Lithuania'],['md','🇲🇩 Moldova'],['nl','🇳🇱 Netherlands'],['pl','🇵🇱 Poland'],
      ['pt','🇵🇹 Portugal'],['rs','🇷🇸 Serbia'],['ru','🇷🇺 Russia'],['se','🇸🇪 Sweden'],['sg','🇸🇬 Singapore'],
      ['si','🇸🇮 Slovenia'],['tr','🇹🇷 Turkey'],['ua','🇺🇦 Ukraine'],['us','🇺🇸 United States'],['vn','🇻🇳 Vietnam']
    ];

    function fillCountrySelect(){
      const sel = $('#country-select'); const gFav = $('#fav-group'); const gAll = $('#all-group');
      const fav = getFavs(); gFav.innerHTML = ''; gAll.innerHTML = '';
      if(fav.length){
        gFav.hidden = false;
        fav.forEach(code=>{
          const item = rawCountries.find(([c])=>c===code); if(item){
            const opt = document.createElement('option'); opt.value=item[0]; opt.textContent=item[1]; gFav.appendChild(opt);
          }
        });
      }else gFav.hidden = true;
      rawCountries.forEach(([code,name])=>{
        const opt = document.createElement('option'); opt.value=code; opt.textContent=name; gAll.appendChild(opt);
      });
    }

    // Favorites
    function getFavs(){ try{ return JSON.parse(localStorage.getItem('cfg-favs')||'[]') }catch{ return [] } }
    function toggleFav(code){
      if(!code) return;
      const fav = new Set(getFavs());
      if(fav.has(code)) fav.delete(code); else fav.add(code);
      localStorage.setItem('cfg-favs', JSON.stringify([...fav]));
      fillCountrySelect();
      $('#country-select').value = code;
    }

    // Filter countries
    $('#country-search').addEventListener('input', e=>{
      const q = e.target.value.toLowerCase().trim();
      const sel = $('#country-select');
      [...sel.options].forEach(opt=>{
        if(opt.value==='') return;
        const show = !q || opt.textContent.toLowerCase().includes(q);
        opt.hidden = !show;
      });
    });

    // ===== Cards =====
    function makeCard(label, url){
      const wrap = document.createElement('div');
      wrap.className = 'config-card card-lite';
      wrap.innerHTML = `
        <div class="d-flex align-items-center justify-content-between gap-2">
          <span class="text-truncate" title="${label}">${label}</span>
          <div class="btn-group btn-group-sm">
            <button class="btn btn-ghost btn-sm btn-icon" data-act="copy" aria-label="${t('btnCopy')}"><span class="ico">📋</span><span class="label" data-i18n-btn="copy">${t('btnCopy')}</span></button>
            <a class="btn btn-ghost btn-sm btn-icon" data-act="open" href="${url}" target="_blank" rel="noopener" aria-label="${t('btnOpen')}"><span class="ico">🔗</span><span class="label" data-i18n-btn="open">${t('btnOpen')}</span></a>
          </div>
        </div>`;
      wrap.addEventListener('click', (e)=>{
        if(e.target.closest('[data-act="copy"]')){ navigator.clipboard.writeText(url).then(()=>toast(t('toastCopied'))); }
      });
      wrap.addEventListener('keyup', (e)=>{ if(e.key==='Enter'){ navigator.clipboard.writeText(url).then(()=>toast(t('toastCopied'))); }});
      return wrap;
    }

    function t(key){ return (i18n[lang]&&i18n[lang][key]) || i18n.en[key] || key }

    function applyLanguage(){
      localStorage.setItem('cfg-lang', lang);
      document.documentElement.lang = lang;
      document.documentElement.dir = ['fa','ar'].includes(lang) ? 'rtl' : 'ltr';

      // متن‌های ثابت
      $('#i-title').textContent = t('title');
      $('#i-kicker').textContent = t('kicker');
      $('#i-desc').textContent = t('desc');
      $('#i-tab-configs').textContent = t('tabCfg');
      $('#i-tab-how').textContent = t('tabHow');
      $('#i-tab-contact').textContent = t('tabContact');
      $('[data-i18n="star"]').textContent = t('star');
      $('[data-i18n="releases"]').textContent = t('releases');
      $('#i-updated').textContent = t('updated');
      $('#i-global-title').textContent = t('title').includes('ConfigForge') ? 'Global subscriptions' : t('title'); // عنوان متفاوت نگه می‌داریم
      $('#i-global-hint').textContent = t('hintGlobal');
      $('#i-country-label').textContent = t('country');
      $('#i-country-search-label').textContent = t('search');
      $('#country-select').options[0].textContent = t('select');
      $('#fav-group').label = t('ogFav'); $('#all-group').label = t('ogAll');
      $('#i-how-title').textContent = t('how');
      $('#i-contact').textContent = t('contact');

      // Steps
      const steps = i18n[lang].howSteps || i18n.en.howSteps;
      $('#i-how-steps').innerHTML = steps.map(s=>`<li>${s}</li>`).join('');

      // دکمه‌ها (بدون بازسازی)
      $$('[data-i18n-btn="copy"]').forEach(el=> el.textContent = t('btnCopy'));
      $$('[data-i18n-btn="open"]').forEach(el=> el.textContent = t('btnOpen'));
      $('#btn-copy-global .label').textContent = t('btnCopyAll');
      $('#btn-load-country .label').textContent = t('btnGet');
      $('#btn-copy-country .label').textContent = t('btnCopyAll');
      $('#btn-fav .label').textContent = t('btnFav');
      $('#btn-show-qr .label').textContent = t('btnQR');

      // Badge سرعت (متن)
      $('#i-speed').textContent = t('speed');

      // رندر ایموجی‌ها
      twemoji.parse(document.body);
    }

    // ===== Data fetching & UI =====
    async function populateGlobal(){
      const box = $('#global-list'); box.innerHTML = '<div class="loading-spinner">⏳</div>';
      const urls = FILES.map(f=>[f, `${CONFIG_ROOT}/${f}`]);
      const oks = await Promise.all(urls.map(([,u])=>headOK(u)));
      box.innerHTML = '';
      urls.forEach(([name,u],i)=>{ if(oks[i]) box.appendChild(makeCard(name, u)); });
      // speed badge
      $('#speed-dot').style.background = oks.some(Boolean) ? 'var(--ok)' : 'var(--err)';
      $('#i-speed').textContent = t('speed') + ' · ' + (oks.some(Boolean) ? t('ready') : t('offline'));
    }

    async function populateCountry(code){
      const box = $('#country-list'); box.innerHTML = '<div class="loading-spinner">⏳</div>';
      const urls = FILES.map(f=>[f, `${CONFIG_ROOT}/${code}/${f}`]);
      const oks = await Promise.all(urls.map(([,u])=>headOK(u)));
      box.innerHTML = '';
      const any = oks.some(Boolean);
      if(!any){ box.innerHTML = `<p class="error-message">${t('select')} → ${t('desc')}</p>`; return }
      urls.forEach(([name,u],i)=>{ if(oks[i]) box.appendChild(makeCard(name, u)); });
      return urls.filter(([,u],i)=>oks[i]).map(([,u])=>u);
    }

    // Copy helpers
    async function copyAll(urls){ if(!urls || !urls.length) return; await navigator.clipboard.writeText(urls.join('\n')); toast(t('toastCopiedAll')) }

    // QR (ساده و سبک)
    function drawQR(text){
      // مینیمال QR: برای سادگی از API خارجی استفاده نمی‌کنیم؛
      // این‌جا یک placeholder pattern ساده می‌کشیم که حداقل به‌عنوان QR Container به کار بیاید.
      // برای QR واقعی می‌تونی lib سبک اضافه کنی (qrious یا qrjs).
      const c = $('#qrCanvas'); const ctx = c.getContext('2d'); const s = c.width;
      ctx.fillStyle = '#111'; ctx.fillRect(0,0,s,s);
      ctx.fillStyle = '#fff';
      // الگوی ساده (نه QR واقعی) — پیشنهاد: بعداً کتابخانه QR اضافه کن
      for(let y=0;y<32;y++){
        for(let x=0;x<32;x++){
          const v = (x*y + text.length + x + y) % 7 === 0;
          if(v) ctx.fillRect(x*8+2, y*8+2, 6, 6);
        }
      }
    }

    // ===== Init =====
    // زبان
    applyLanguage();
    $('#language-select').value = lang;
    $('#language-select').addEventListener('change', e=>{
      lang = i18n[e.target.value] ? e.target.value : 'en';
      applyLanguage();
      const params = new URLSearchParams(location.search);
      params.set('lang', lang);
      history.replaceState(null, '', `?${params.toString()}`);
    });

    // کشورها
    fillCountrySelect();
    // autodetect
    fetch('https://ipapi.co/json/').then(r=>r.json()).then(d=>{
      const code = (d.country_code||'').toLowerCase();
      const sel = $('#country-select');
      if(code && [...sel.options].some(o=>o.value===code)) sel.value = code;
    }).catch(()=>{});

    // last updated
    (async ()=>{
      try{
        let r = await fetch(`${CONFIG_ROOT}/all.txt`, { method:'HEAD', cache:'no-store' });
        if(!r.ok) r = await fetch(`${CONFIG_ROOT}/all.txt`, { cache:'no-store' });
        const lm = r.headers.get('last-modified') || r.headers.get('date');
        if(lm) $('#i-updated-when').textContent = ' ' + new Date(lm).toUTCString();
      }catch{ $('#i-updated-when').textContent = ' —' }
    })();

    // global
    populateGlobal();

    // deep-link
    (function(){
      const q = new URLSearchParams(location.search);
      const qLang = q.get('lang'); const qCountry = q.get('country');
      if(qLang && i18n[qLang]){ lang = qLang; $('#language-select').value = lang; applyLanguage(); }
      if(qCountry){ $('#country-select').value = qCountry }
    })();

    // Tooltips
    new bootstrap.Tooltip($('#btn-fav'));

    // actions
    $('#btn-copy-global').addEventListener('click', async ()=>{
      const urls = [];
      for(const f of FILES){
        const u = `${CONFIG_ROOT}/${f}`; if(await headOK(u)) urls.push(u);
      }
      copyAll(urls);
    });

    $('#btn-load-country').addEventListener('click', async ()=>{
      const code = $('#country-select').value; if(!code){ toast(t('select')); return; }
      const list = await populateCountry(code);
      const params = new URLSearchParams(location.search); params.set('country', code);
      history.replaceState(null,'',`?${params.toString()}`);
      // ستاره وضعیت
      $('#btn-fav').classList.toggle('btn-primary', getFavs().includes(code));
    });

    $('#btn-copy-country').addEventListener('click', async ()=>{
      const code = $('#country-select').value; if(!code){ toast(t('select')); return; }
      const urls = [];
      for(const f of FILES){ const u = `${CONFIG_ROOT}/${code}/${f}`; if(await headOK(u)) urls.push(u); }
      copyAll(urls);
    });

    $('#btn-fav').addEventListener('click', ()=>{
      const code = $('#country-select').value; if(!code){ toast(t('select')); return; }
      toggleFav(code);
      $('#btn-fav').classList.toggle('btn-primary', getFavs().includes(code));
    });

    $('#btn-show-qr').addEventListener('click', async ()=>{
      const code = $('#country-select').value;
      if(!code){ toast(t('select')); return; }
      // یکی از URLها (all.txt) را برای QR نشان می‌دهیم
      const url = `${CONFIG_ROOT}/${code}/all.txt`;
      if(!(await headOK(url))){ toast(t('offline')); return; }
      drawQR(url);
      const m = new bootstrap.Modal('#qrModal'); m.show();
      $('#qrTitle').textContent = `QR · ${code.toUpperCase()}`;
    });

    // پارالاکس خیلی سبک
    (function(){
      let raf;
      window.addEventListener('scroll', ()=>{
        if(raf) return;
        raf = requestAnimationFrame(()=>{
          const y = window.scrollY || 0;
          $('.parallax').style.transform = `translateY(${y * 0.15}px)`;
          raf = null;
        });
      }, {passive:true});
    })();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
