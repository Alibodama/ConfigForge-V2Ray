<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ConfigForge V2Ray</title>
  <!-- SEO / Social -->
  <meta name="description" content="Fetch, organize, and copy ready-to-use V2Ray subscription links (VLESS, VMess, Shadowsocks, Trojan) with speed-tested nodes." />
  <meta property="og:title" content="ConfigForge V2Ray" />
  <meta property="og:description" content="Speed-tested, ready-to-use subscription links by country or global." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://opengraph.githubassets.com/1/ShatakVPN/ConfigForge-V2Ray" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>⚙️</text></svg>">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Emoji&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js"></script>
  <style>
    :root { --fg:#e2e8f0; --muted:#cbd5e1; --glass:rgba(255,255,255,0.05); --glass-2:rgba(255,255,255,0.1); }
    * { box-sizing: border-box; }
    body {
      background: linear-gradient(180deg, rgba(10,25,47,0.95), rgba(30,41,59,0.95)),
        url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"%3E%3Cpath fill="none" stroke="%23ffffff" stroke-opacity="0.1" stroke-width="2" d="M0,160L48,176C96,192,192,224,288,213.3C384,203,480,149,576,149.3C672,149,768,203,864,213.3C960,224,1056,192,1152,176C1248,160,1344,160,1392,160L1440,160L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"%3E%3C/path%3E%3C/svg%3E');
      background-size: cover; min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: space-between; font-family: 'Inter', sans-serif; color: var(--fg); padding: 4rem 1rem;
    }
    .container {
      background: var(--glass); backdrop-filter: blur(15px); padding: 2rem; border-radius: 16px;
      box-shadow: 0 10px 50px rgba(0,0,0,0.3); max-width: 980px; width: 100%; border: 1px solid rgba(255,255,255,0.1); position: relative;
      animation: fadeIn .6s ease-out;
    }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(-14px);} to{opacity:1; transform:none;} }
    h1 { text-align:center; margin-bottom: .5rem; font-weight:700; color:#fff; letter-spacing:-0.02em; }
    .kicker { text-align:center; margin-bottom: 1.25rem; color: var(--muted); font-size: .95rem; }
    .badge-row { display:flex; gap:.5rem; justify-content:center; flex-wrap:wrap; margin-bottom:1rem; }
    .description { text-align:center; margin-bottom: 1.25rem; font-size: 1.02rem; color: var(--muted); opacity:.95; }

    .nav-tabs { border-bottom:none; justify-content:center; margin-bottom:1.25rem; }
    .nav-tabs .nav-link { background: var(--glass-2); color: var(--fg); border:none; margin:0 .5rem; border-radius: 8px 8px 0 0; }
    .nav-tabs .nav-link.active { background: rgba(255,255,255,0.2); color:#fff; box-shadow: 0 -2px 10px rgba(0,0,0,0.2); }
    .tab-content { animation: fadeIn .3s ease; }

    .grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(220px,1fr)); gap: .75rem; }
    .card-lite { background: rgba(255,255,255,0.08); border:1px solid rgba(255,255,255,0.12); border-radius: 12px; padding: 1rem; }
    .config-card { cursor:pointer; transition: transform .15s ease, box-shadow .15s ease; font-weight:600; text-align:center; padding:1rem; }
    .config-card:hover { transform: translateY(-3px); box-shadow: 0 8px 22px rgba(0,0,0,0.25); }
    .btn-primary { background: linear-gradient(90deg, #3b82f6, #7c3aed); border:none; font-weight:600; }

    .toolbar { display:flex; gap:.5rem; align-items:center; justify-content:space-between; flex-wrap:wrap; margin-bottom:.75rem; }
    #language-select { width: 140px; }

    .error-message{ color:#f87171; text-align:center; font-weight:500; }
    .loading-spinner { text-align:center; font-size:1.4rem; }

    footer { padding: 1.25rem; text-align:center; color: var(--muted); font-size:.9rem; }
    footer a { color:#93c5fd; font-weight:600; text-decoration:none; }
    footer a:hover { text-decoration:underline; color:#fff; }

    [dir="rtl"] { text-align:right; }
    canvas { position: fixed; inset:0; width:100%; height:100%; z-index:-1; opacity:.28; }
    @media (prefers-reduced-motion: reduce){ .config-card:hover { transform:none; } }
  </style>
</head>
<body>
  <canvas id="particles" aria-hidden="true"></canvas>

  <div class="container" role="main">
    <div class="toolbar">
      <div>
        <h1 id="title" class="mb-0">ConfigForge V2Ray</h1>
        <div class="kicker" id="kicker">Speed‑tested subscription links · VLESS · VMess · Shadowsocks · Trojan</div>
      </div>
      <select id="language-select" class="form-select" aria-label="Language switcher">
        <option value="en">English</option>
        <option value="fa">فارسی</option>
        <option value="zh">中文 (简体)</option>
        <option value="es">Español</option>
        <option value="fr">Français</option>
        <option value="de">Deutsch</option>
        <option value="ru">Русский</option>
        <option value="ar">العربية</option>
        <option value="ja">日本語</option>
        <option value="ko">한국어</option>
        <option value="hi">हिन्दी</option>
        <option value="pt">Português</option>
        <option value="it">Italiano</option>
        <option value="tr">Türkçe</option>
        <option value="nl">Nederlands</option>
      </select>
    </div>

    <!-- Badges (stars, release) -->
    <div class="badge-row">
      <a class="btn btn-sm btn-outline-light" href="https://github.com/ShatakVPN/ConfigForge-V2Ray" target="_blank" rel="noopener">⭐ Star on GitHub</a>
      <a class="btn btn-sm btn-outline-light" href="https://github.com/ShatakVPN/ConfigForge-V2Ray/releases" target="_blank" rel="noopener">📦 Releases</a>
      <span class="badge text-bg-primary">Speed test ready</span>
      <span id="last-updated" class="badge text-bg-secondary" title="Last updated (UTC)">Updated: —</span>
    </div>

    <p class="description" id="description">Pick a country or use global subscriptions. Click a card to copy the raw subscription URL.</p>

    <ul class="nav nav-tabs" id="myTab" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="configs-tab" data-bs-toggle="tab" data-bs-target="#configs" type="button" role="tab" aria-controls="configs" aria-selected="true">Get Configs</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="howto-tab" data-bs-toggle="tab" data-bs-target="#howto" type="button" role="tab" aria-controls="howto" aria-selected="false">How to Use</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact" type="button" role="tab" aria-controls="contact" aria-selected="false">Contact</button>
      </li>
    </ul>

    <div class="tab-content" id="myTabContent">
      <!-- CONFIGS TAB -->
      <div class="tab-pane fade show active" id="configs" role="tabpanel" aria-labelledby="configs-tab">
        <!-- Global subscriptions quick access -->
        <div class="card-lite mb-3">
          <div class="d-flex justify-content-between align-items-center flex-wrap gap-2">
            <strong id="global-heading">Global subscriptions</strong>
            <div class="small text-secondary" id="global-hint">Works in most clients. Click to copy URL.</div>
          </div>
          <div id="global-list" class="grid mt-2" aria-live="polite"></div>
        </div>

        <div class="row g-3 align-items-end">
          <div class="col-sm-6">
            <label for="country-select" class="form-label" id="country-label">Country</label>
            <select id="country-select" class="form-select">
              <option value="">Select Country</option>
              <option value="at">🇦🇹 Austria</option>
              <option value="au">🇦🇺 Australia</option>
              <option value="bg">🇧🇬 Bulgaria</option>
              <option value="br">🇧🇷 Brazil</option>
              <option value="ca">🇨🇦 Canada</option>
              <option value="ch">🇨🇭 Switzerland</option>
              <option value="cz">🇨🇿 Czech Republic</option>
              <option value="de">🇩🇪 Germany</option>
              <option value="es">🇪🇸 Spain</option>
              <option value="fi">🇫🇮 Finland</option>
              <option value="fr">🇫🇷 France</option>
              <option value="gb">🇬🇧 United Kingdom</option>
              <option value="hk">🇭🇰 Hong Kong</option>
              <option value="hu">🇭🇺 Hungary</option>
              <option value="id">🇮🇩 Indonesia</option>
              <option value="il">🇮🇱 Israel</option>
              <option value="in">🇮🇳 India</option>
              <option value="ir">🇮🇷 Iran</option>
              <option value="it">🇮🇹 Italy</option>
              <option value="jp">🇯🇵 Japan</option>
              <option value="kr">🇰🇷 South Korea</option>
              <option value="kz">🇰🇿 Kazakhstan</option>
              <option value="lt">🇱🇹 Lithuania</option>
              <option value="md">🇲🇩 Moldova</option>
              <option value="nl">🇳🇱 Netherlands</option>
              <option value="pl">🇵🇱 Poland</option>
              <option value="pt">🇵🇹 Portugal</option>
              <option value="rs">🇷🇸 Serbia</option>
              <option value="ru">🇷🇺 Russia</option>
              <option value="se">🇸🇪 Sweden</option>
              <option value="sg">🇸🇬 Singapore</option>
              <option value="si">🇸🇮 Slovenia</option>
              <option value="tr">🇹🇷 Turkey</option>
              <option value="ua">🇺🇦 Ukraine</option>
              <option value="us">🇺🇸 United States</option>
              <option value="vn">🇻🇳 Vietnam</option>
            </select>
          </div>
          <div class="col-sm-6 d-grid d-sm-block">
            <button id="get-configs" class="btn btn-primary w-100 w-sm-auto">Get Configs</button>
          </div>
        </div>

        <div id="configs-list" class="grid mt-3" aria-live="polite"></div>
      </div>

      <!-- HOW TO TAB -->
      <div class="tab-pane fade" id="howto" role="tabpanel" aria-labelledby="howto-tab">
        <div class="card-lite">
          <h3 class="h5 mb-3" id="howto-heading">Quick import</h3>
          <ol class="mb-3" id="howto-steps">
            <li>Copy a subscription URL from a card.</li>
            <li>Open your client (v2rayNG, V2RayN, Shadowrocket, etc.).</li>
            <li>Find <em>Subscriptions</em> → <em>Add</em> → paste URL → <em>Update</em>.</li>
          </ol>
          <div class="row g-3">
            <div class="col-md-6">
              <div class="card-lite p-3">
                <strong>Android</strong>
                <ul class="mb-0">
                  <li><a href="https://github.com/2dust/v2rayNG" target="_blank" rel="noopener">v2rayNG</a></li>
                  <li><a href="https://github.com/MatsuriDayo/NekoBoxForAndroid" target="_blank" rel="noopener">NekoBox</a></li>
                </ul>
              </div>
            </div>
            <div class="col-md-6">
              <div class="card-lite p-3">
                <strong>iOS</strong>
                <ul class="mb-0">
                  <li><a href="https://apps.apple.com/us/app/shadowrocket/id932747118" target="_blank" rel="noopener">Shadowrocket</a></li>
                  <li><a href="https://apps.apple.com/us/app/quantumult-x/id1443988620" target="_blank" rel="noopener">Quantumult X</a></li>
                </ul>
              </div>
            </div>
            <div class="col-md-6">
              <div class="card-lite p-3 mt-3">
                <strong>Windows</strong>
                <ul class="mb-0">
                  <li><a href="https://github.com/2dust/v2rayN" target="_blank" rel="noopener">V2RayN</a></li>
                  <li><a href="https://github.com/Qv2ray/Qv2ray" target="_blank" rel="noopener">Qv2ray</a></li>
                </ul>
              </div>
            </div>
            <div class="col-md-6">
              <div class="card-lite p-3 mt-3">
                <strong>Linux / Mac</strong>
                <ul class="mb-0">
                  <li><a href="https://github.com/v2rayA/v2rayA" target="_blank" rel="noopener">v2rayA</a></li>
                  <li><a href="https://github.com/yanue/V2rayU" target="_blank" rel="noopener">V2RayU (macOS)</a></li>
                  <li><a href="https://github.com/yichengchen/clashX" target="_blank" rel="noopener">ClashX (macOS)</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- CONTACT TAB -->
      <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">
        <div class="card-lite p-3 text-center">
          <p id="contact-text">Reach us on GitHub or email.</p>
          <p class="mb-0"><a href="https://github.com/ShatakVPN" target="_blank" rel="noopener">GitHub: ShatakVPN</a> · <a href="mailto:ShatakVPN@gmail.com">ShatakVPN@gmail.com</a></p>
        </div>
      </div>
    </div>

  </div>

  <footer id="footer">Built with ❤️ by <a href="https://github.com/ShatakVPN" target="_blank" rel="noopener">ShatakVPN</a> · Powered by <a href="https://github.com" target="_blank" rel="noopener">GitHub</a> & <a href="https://check-host.net" target="_blank" rel="noopener">Check‑Host</a></footer>

  <!-- Toasts -->
  <div class="position-fixed top-0 end-0 p-3" style="z-index: 1080">
    <div id="toast" class="toast align-items-center text-bg-dark border-0" role="status" aria-live="polite" aria-atomic="true">
      <div class="d-flex">
        <div id="toast-body" class="toast-body">Copied to clipboard.</div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>
  </div>

  <script>
    // Twemoji
    twemoji.parse(document.body, { folder: 'svg', ext: '.svg', base: 'https://cdn.jsdelivr.net/npm/twemoji@14.0.2/2/' });

    // i18n strings (added minimal new keys)
    const translations = {
      en: {
        title: 'ConfigForge V2Ray',
        kicker: 'Speed‑tested subscription links · VLESS · VMess · Shadowsocks · Trojan',
        description: 'Pick a country or use global subscriptions. Click a card to copy the raw subscription URL.',
        configsTab: 'Get Configs', howtoTab: 'How to Use', contactTab: 'Contact',
        selectCountry: 'Select Country', countryLabel: 'Country', getBtns: 'Get Configs',
        noConfigs: 'No configs found for this country.', error: 'Error fetching configs. Please try again later.',
        copied: 'Subscription URL copied.',
        globalHeading: 'Global subscriptions', globalHint: 'Works in most clients. Click to copy URL.',
        howtoHeading: 'Quick import', howtoSteps: ['Copy a subscription URL from a card.','Open your client (v2rayNG, V2RayN, Shadowrocket, etc.).','Find Subscriptions → Add → paste URL → Update.'],
        contactText: 'Reach us on GitHub or email.'
      },
      fa: {
        title: 'ConfigForge V2Ray',
        kicker: 'ساب‌های تست‌شده · VLESS · VMess · Shadowsocks · Trojan',
        description: 'کشور را انتخاب کنید یا از ساب‌های عمومی استفاده کنید. روی کارت کلیک کنید تا لینک کپی شود.',
        configsTab: 'دریافت کانفیگ', howtoTab: 'روش استفاده', contactTab: 'ارتباط',
        selectCountry: 'انتخاب کشور', countryLabel: 'کشور', getBtns: 'دریافت کانفیگ',
        noConfigs: 'برای این کشور فایلی پیدا نشد.', error: 'خطا در دریافت فایل‌ها. بعداً تلاش کنید.',
        copied: 'لینک اشتراک کپی شد.',
        globalHeading: 'اشتراک‌های عمومی', globalHint: 'در اکثر کلاینت‌ها کار می‌کند. کلیک = کپی لینک.',
        howtoHeading: 'ورود سریع', howtoSteps: ['یک لینک اشتراک را از کارت کپی کنید.','کلاینت خود را باز کنید (v2rayNG، V2RayN، Shadowrocket و …).','Subscriptions → Add → پیست لینک → Update.'],
        contactText: 'در گیت‌هاب یا ایمیل پیام بدهید.'
      }
      // (other languages can fall back to English)
    };

    const prefersLang = (localStorage.getItem('cfg-lang') || navigator.language.substring(0,2) || 'en');
    let currentLang = translations[prefersLang] ? prefersLang : 'en';

    function setText(id, text){ const el = document.getElementById(id); if(el) el.textContent = text; }
    function setHTML(id, html){ const el = document.getElementById(id); if(el) el.innerHTML = html; }

    function updateLanguage(lang){
      currentLang = translations[lang] ? lang : 'en';
      localStorage.setItem('cfg-lang', currentLang);
      document.documentElement.lang = currentLang;
      document.documentElement.dir = ['fa','ar'].includes(currentLang) ? 'rtl' : 'ltr';
      setText('title', translations[currentLang].title);
      setText('kicker', translations[currentLang].kicker);
      setText('configs-tab', translations[currentLang].configsTab);
      setText('howto-tab', translations[currentLang].howtoTab);
      setText('contact-tab', translations[currentLang].contactTab);
      setText('country-label', translations[currentLang].countryLabel);
      document.querySelector('#country-select').options[0].textContent = translations[currentLang].selectCountry;
      setText('get-configs', translations[currentLang].getBtns);
      setText('global-heading', translations[currentLang].globalHeading);
      setText('global-hint', translations[currentLang].globalHint);
      setText('howto-heading', translations[currentLang].howtoHeading);
      setText('description', translations[currentLang].description);
      setText('contact-text', translations[currentLang].contactText);
      // steps
      const steps = translations[currentLang].howtoSteps || translations['en'].howtoSteps;
      const ol = document.getElementById('howto-steps');
      if(ol){ ol.innerHTML = steps.map(s=>`<li>${s}</li>`).join(''); }
      twemoji.parse(document.body);
    }

    // init language
    updateLanguage(currentLang);
    document.getElementById('language-select').value = currentLang;
    document.getElementById('language-select').addEventListener('change', e=> updateLanguage(e.target.value));

    // Toast helper
    const toastEl = document.getElementById('toast');
    const toastBody = document.getElementById('toast-body');
    let bsToast = null;
    function showToast(msg){
      toastBody.textContent = msg;
      if(!bsToast){ bsToast = new bootstrap.Toast(toastEl, { delay: 1800 }); }
      bsToast.show();
    }

    // Utilities
    const CONFIG_ROOT = 'https://raw.githubusercontent.com/ShatakVPN/ConfigForge-V2Ray/main/configs';
    const FILES = ['all.txt','light.txt','vless.txt','vmess.txt','shadowsocks.txt','trojan.txt','unknown.txt'];

    async function headExists(url){ try { const r = await fetch(url, { method:'HEAD' }); return r.ok; } catch { return false; } }

    function makeCard(label, url){
      const div = document.createElement('div');
      div.className = 'config-card card-lite';
      div.tabIndex = 0; // keyboard accessible
      div.innerHTML = `<div class="d-flex align-items-center justify-content-between gap-2">
        <span>${label}</span>
        <div class="btn-group btn-group-sm">
          <button class="btn btn-outline-light" data-action="copy">Copy</button>
          <a class="btn btn-outline-light" href="${url}" target="_blank" rel="noopener">Open</a>
        </div>
      </div>`;
      div.addEventListener('click', (e)=>{
        const target = e.target.closest('[data-action="copy"]');
        if(target){
          navigator.clipboard.writeText(url).then(()=> showToast((translations[currentLang]||translations.en).copied));
        }
      });
      div.addEventListener('keyup', (e)=>{ if(e.key === 'Enter'){ navigator.clipboard.writeText(url).then(()=> showToast((translations[currentLang]||translations.en).copied)); }});
      return div;
    }

    async function populateGlobal(){
      const wrap = document.getElementById('global-list');
      wrap.innerHTML = '<div class="loading-spinner">⏳</div>';
      const urls = FILES.map(f => [f, `${CONFIG_ROOT}/${f}`]);
      const checks = await Promise.all(urls.map(([,u])=> headExists(u)));
      wrap.innerHTML = '';
      urls.forEach(([f,u], i)=>{ if(checks[i]) wrap.appendChild(makeCard(f, u)); });
    }

    async function populateCountry(country){
      const list = document.getElementById('configs-list');
      list.innerHTML = '<div class="loading-spinner">⏳</div>';
      const urls = FILES.map(f => [f, `${CONFIG_ROOT}/${country}/${f}`]);
      const checks = await Promise.all(urls.map(([,u])=> headExists(u)));
      list.innerHTML = '';
      const any = checks.some(Boolean);
      if(!any){ list.innerHTML = `<p class="error-message">${(translations[currentLang]||translations.en).noConfigs}</p>`; return; }
      urls.forEach(([f,u], i)=>{ if(checks[i]) list.appendChild(makeCard(f, u)); });
    }

    // Country autodetect
    fetch('https://ipapi.co/json/').then(r=>r.json()).then(data=>{
      const code = (data.country_code||'').toLowerCase();
      const sel = document.getElementById('country-select');
      if(code && sel.querySelector(`option[value="${code}"]`)) sel.value = code;
    }).catch(()=>{});

    // Last updated indicator (best-effort using the top-level all.txt header)
    (async function(){
      try {
        const r = await fetch(`${CONFIG_ROOT}/all.txt`, { method:'HEAD' });
        const date = r.headers.get('last-modified');
        if(date) document.getElementById('last-updated').textContent = `Updated: ${new Date(date).toUTCString()}`;
      } catch {}
    })();

    // Populate global on load
    populateGlobal();

    // Deep-linking via query params (?lang=fa&country=de)
    (function(){
      const params = new URLSearchParams(location.search);
      const lang = params.get('lang');
      const country = params.get('country');
      if(lang) { updateLanguage(lang); document.getElementById('language-select').value = lang; }
      if(country) { const sel = document.getElementById('country-select'); if(sel.querySelector(`option[value="${country}"]`)) { sel.value = country; populateCountry(country); } }
    })();

    // Button handler
    document.getElementById('get-configs').addEventListener('click', ()=>{
      const country = document.getElementById('country-select').value;
      if(!country){ showToast((translations[currentLang]||translations.en).selectCountry); return; }
      populateCountry(country);
    });

    // Particles (simple, low-cost)
    const canvas = document.getElementById('particles');
    const ctx = canvas.getContext('2d');
    function resize(){ canvas.width = innerWidth; canvas.height = innerHeight; }
    resize();
    const particles = Array.from({length: 50}, () => ({ x: Math.random()*canvas.width, y: Math.random()*canvas.height, r: Math.random()*2+1, vx: (Math.random()-.5)*.5, vy: (Math.random()-.5)*.5 }));
    function tick(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      for(const p of particles){ p.x+=p.vx; p.y+=p.vy; if(p.x<0||p.x>canvas.width) p.vx*=-1; if(p.y<0||p.y>canvas.height) p.vy*=-1; ctx.fillStyle='rgba(255,255,255,.8)'; ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fill(); }
      requestAnimationFrame(tick);
    }
    tick();
    addEventListener('resize', resize);
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
